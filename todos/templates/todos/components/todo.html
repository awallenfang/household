{% load static%}
<div class="collapsible-container draggable-container" todo-id="{{todo.id}}">
        
    <div class="todo">
        <div class="todo-header">
            <div >
                <img src="{% static 'todos/assets/drag.svg' %}" class="todo_drag_handle" draggable="false">
                <p class="todo-name">{{ todo.name }}</p>
                {% if todo.recurrent_state is not None%}
                    <img src="{% static 'todos/assets/refresh.svg' %}" class="recurrent_refresh_icon" >
                {% endif %}
            </div>
            {%if todo.assigned_user is not None%}
                <p>{{todo.assigned_user.auth_user.username}}</p>
            {%endif%}
        </div>
        <div class="todo-buttons">
            <button class="dropdown-button" onclick="toggleDropdown(event)">...</button>
        </div>
    </div>
    <div class="collapsible-content dropdown-closed">
        <div class="todo-collapsible-content">
                <div class="todo-description-container">
                    <p class="todo-description">{{todo.description}} </p>
                </div>
                <div class="todo-additional-info">
                    <a class="button btn-small" hx-post="{% url 'todos:edit_todo' todo.id %}"
                    hx-target="closest .collapsible-container"
                    hx-swap="outerHTML">Edit</a>
                    {% if todo.recurrent_state is None%}
                        <a class="button btn-small" 
                        hx-get="{% url 'todos:make_recurrent' todo.id %}"
                        hx-target="closest .collapsible-container"
                        hx-swap="innerHTML">Make recurrent</a>
                    {%else%}
                        <a class="button btn-small" 
                        hx-get="{% url 'todos:recurrency_editor' todo.id %}"
                        hx-target="#recurrent-block"
                        hx-swap="innerHTML"
                        onclick="clearSelectedUsers()">Recurrency</a>
                    {% endif %}
                    
                    <div class="button-center-container">
                        <a class="button btn-small" 
                        hx-delete="{% url 'todos:delete_todo' todo.id %}" 
                        hx-confirm="Are you sure you would like to delete this todo?"
                        hx-target="#todo-list"
                        >
                            Delete!
                        </a>
                    </div>
                    <p>Assigned user:</p>
                    {%if todo.assigned_user is not None%}
                        <p>{{todo.assigned_user.auth_user.username}}</p>
                    {%else%}
                        <p>No one</p>
                    {%endif%}
                </div>
        </div>
    </div>
</div>